<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Seguridad ISYSA | Reporte de Observaciones</title>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.28/jspdf.plugin.autotable.min.js"></script>

    <style>
        :root {
            --night-blue: #002344; 
            --azul-claro: #004d82;
            --azul-acento: #007bff;
            --blanco: #ffffff;
            --gris-fondo: #f1f5f9;
            --borde: #cbd5e1;
            --texto: #0f172a;
            --error: #ef4444;
        }

        body { 
            font-family: 'Segoe UI', Roboto, Helvetica, Arial, sans-serif; 
            background: #e2e8f0;
            padding: 15px; 
            color: var(--texto);
            margin: 0;
            display: flex;
            justify-content: center;
        }

        .container { 
            max-width: 850px; 
            width: 100%;
            background: var(--blanco); 
            border-radius: 16px; 
            box-shadow: 0 10px 25px rgba(0,0,0,0.1); 
            overflow: hidden;
            margin: 20px 0;
        }

        /* --- MEJORA DEL ENCABEZADO --- */
        .header {
            background-color: var(--night-blue);
            padding: 30px 40px;
            color: white;
            display: flex;
            flex-direction: row; /* Alineación horizontal */
            justify-content: space-between; /* Título izquierda, logo derecha */
            align-items: center; /* Centrado vertical entre ambos */
            gap: 20px;
        }

        .header h1 { 
            margin: 0; 
            font-size: 1.6rem; 
            letter-spacing: 1px;
            text-transform: uppercase;
            text-align: left;
            flex: 1; /* Toma el espacio disponible a la izquierda */
        }

        .header img {
            max-height: 110px; /* Logo más grande para que resalte */
            width: auto;
            filter: drop-shadow(0px 4px 6px rgba(0,0,0,0.2)); /* Sombra ligera al logo */
        }

        /* --- RESTO DEL FORMULARIO --- */
        form { padding: 30px; }

        .grid-2 {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        @media (max-width: 600px) {
            .header {
                flex-direction: column-reverse; /* Logo arriba, título abajo en móvil */
                text-align: center;
                padding: 20px;
            }
            .header h1 {
                text-align: center;
                font-size: 1.2rem;
            }
            .grid-2 { grid-template-columns: 1fr; }
            form { padding: 20px; }
        }

        .form-group { margin-bottom: 18px; }

        .section { 
            margin: 25px 0;
            padding: 20px; 
            border-radius: 12px; 
            background-color: var(--gris-fondo);
            border-left: 5px solid var(--night-blue);
        }

        h3 { 
            color: var(--night-blue);
            font-size: 1.1rem;
            margin-top: 0;
            border-bottom: 1px solid var(--borde);
            padding-bottom: 10px;
        }

        label { 
            display: block; 
            margin-bottom: 6px; 
            font-weight: 600; 
            font-size: 0.9rem;
            color: #334155;
        }

        input, select, textarea { 
            width: 100%; 
            padding: 12px; 
            border: 1px solid var(--borde); 
            border-radius: 8px; 
            font-size: 1rem;
            transition: border-color 0.3s, box-shadow 0.3s;
            background: white;
            box-sizing: border-box; /* Evita que el input se salga del contenedor */
        }

        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: var(--azul-acento);
            box-shadow: 0 0 0 3px rgba(0, 123, 255, 0.1);
        }

        .checkbox-grid { 
            display: grid; 
            grid-template-columns: repeat(auto-fill, minmax(240px, 1fr));
            gap: 8px; 
            padding: 12px;
            background: white;
            border-radius: 8px;
            border: 1px solid var(--borde);
            max-height: 200px;
            overflow-y: auto;
        }

        .checkbox-item { 
            display: flex; 
            align-items: center;
            font-size: 0.85rem;
            gap: 8px;
        }

        .checkbox-item input { width: auto; }

        button { 
            width: 100%; 
            background: var(--night-blue);
            color: white; 
            padding: 16px; 
            border: none; 
            border-radius: 8px; 
            font-size: 1rem; 
            font-weight: bold;
            cursor: pointer; 
            transition: background 0.3s;
            margin-top: 20px;
        }

        button:hover { background: var(--azul-claro); }
        button:disabled { background: #94a3b8; cursor: not-allowed; }
        
        .hidden { display: none; }
        .mt-2 { margin-top: 10px; }

        .file-label {
            font-size: 0.8rem;
            color: var(--azul-claro);
            margin-top: 5px;
            display: block;
        }
    </style>
</head>
<body>

<div class="container">
    <div class="header">
        <h1>Observaciones de Seguridad ISYSA</h1>
        <img id="logoForm" src="data:image/png;base64,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" alt="Logo ISYSA">
    </div>

    <form id="seguridadForm">
        <div class="form-group">
            <label>Correo Electrónico *</label>
            <input type="email" name="correo" placeholder="ejemplo@isysa.com" required>
        </div>

        <div class="grid-2">
            <div class="form-group">
                <label>Fecha *</label>
                <input type="date" name="fecha" id="fechaActual" required>
            </div>
            <div class="form-group">
                <label>Lugar de Observación *</label>
                <select name="sitio" id="sitioSelect" onchange="toggleOtroLugar()" required>
                    <option value="">Seleccione lugar...</option>
                    <option value="Almacén">Almacén</option>
                    <option value="Biología">Biología</option>
                    <option value="Calidad">Calidad</option>
                    <option value="Campo">Campo</option>
                    <option value="Embarques">Embarques</option>
                     <option value="Lavadoras">Lavadoras</option>
                    <option value="Molinos">Molinos</option>
                    <option value="Oficinas">Oficinas</option>
                    <option value="Registro (Vigilancia)">Registro (Vigilancia)</option>
                    <option value="Mantto. Industrial">Mantto. Industrial</option>
                    <option value="Mantto. Automotriz">Mantto. Automotriz</option>
                     <option value="Transporte">Transporte</option>
                    <option value="Otro">Otro</option>
                </select>
                <input type="text" name="otroSitio" id="otroSitio" class="hidden mt-2" placeholder="Especifique el lugar">
            </div>
        </div>

        <div class="form-group">
            <label>Observador *</label>
            <input type="text" list="listaObservadores" name="observador" placeholder="Nombre de quien observa" required>
            <datalist id="listaObservadores"></datalist>
        </div>

        <div class="form-group">
            <label>Tipo de Observación *</label>
            <select id="tipoObservacion" name="tipoObservacion" onchange="toggleSections()" required>
                <option value="">-- Seleccione una opción --</option>
                <option value="acto">Observación de Seguridad</option>
                <option value="condicion">Condición Insegura</option>
            </select>
        </div>

        <div id="seccionActo" class="section hidden">
            <h3>I. OBSERVACIÓN DE SEGURIDAD</h3>
            <div class="form-group">
                <label>Persona Observada *</label>
                <input type="text" list="listaObservados" name="observado" id="inputObservado" placeholder="Nombre de quien es observado">
                <datalist id="listaObservados"></datalist>
            </div>
            <div class="form-group">
                <label>¿Realiza su actividad de forma segura?</label>
                <select name="actividadSegura" id="actividadSegura" onchange="toggleEvita()">
                    <option value="SI">SÍ</option>
                    <option value="NO">NO</option>
                </select>
            </div>
            <div id="queEvita" class="form-group hidden">
                <label>¿Qué evita que el trabajador realice sus actividades de forma segura?</label>
                <select name="razonInsegura" id="razonInseguraSelect" onchange="toggleOtroRazon()">
                    <option value="">-- Seleccione una razón --</option>
                    <option value="Herramientas, equipos o maquinaria inadecuados, no disponibles o en malas condiciones">Herramientas, equipos o maquinaria inadecuados, no disponibles o en malas condiciones</option>
                    <option value="Diseño inadecuado de las instalaciones.">Diseño inadecuado de las instalaciones.</option>
                    <option value="Diseño inadecuado del proceso">Diseño inadecuado del proceso</option>
                    <option value="Equipo de protección personal no disponible o nunca solicitado">Equipo de protección personal no disponible o nunca solicitado</option>
                    <option value="Nunca ha recibido capacitación al respecto">Nunca ha recibido capacitación al respecto</option>
                    <option value="Otro">Otro</option>
                </select>
                <input type="text" name="otroRazonInsegura" id="otroRazonInsegura" class="hidden mt-2" placeholder="Especifique la razón">
            </div>
            <div class="form-group">
                <label>¿Se cuenta con lo necesario para hacer la actividad de forma segura?</label>
                <select name="provisto" id="provistoSelect" onchange="toggleProvisto()">
                    <option value="SI">SÍ</option>
                    <option value="NO">NO</option>
                </select>
            </div>
            
            <div id="queFalta" class="form-group hidden">
                <label>Especifique faltante:</label>
                <div class="checkbox-grid">
                    <label class="checkbox-item"><input type="checkbox" name="falta" value="Capacitación"> Capacitación</label>
                    <label class="checkbox-item"><input type="checkbox" name="falta" value="Herramientas"> Herramientas</label>
                    <label class="checkbox-item"><input type="checkbox" name="falta" value="EPP"> Equipo de Protección (EPP)</label>
                    <label class="checkbox-item"><input type="checkbox" name="falta" value="Materiales"> Materiales</label>
                    <label class="checkbox-item"><input type="checkbox" name="falta" value="Equipos adecuados"> Equipos adecuados</label>
                    <label class="checkbox-item"><input type="checkbox" name="falta" value="Análisis"> Falta el análisis previo</label>
                    <label class="checkbox-item"><input type="checkbox" name="falta" value="Controles"> Falta instalar controles</label>
                    <label class="checkbox-item"><input type="checkbox" name="falta" value="Otro" id="checkOtroFaltante" onchange="toggleOtroFaltante()"> Otro</label>
                </div>
                <input type="text" name="otroFaltante" id="otroFaltante" class="hidden mt-2" placeholder="Especifique qué falta">
            <div class="form-group">
                <label>FAVOR DE DAR AVISO AL SUPERVISOR O JEFE DE ÁREA DE LA NECESIDAD FALTANTE</label>
            </div>
            </div>
         <div class="form-group">
                <label>Estado identificado:</label>
                <select name="estadoComportamiento">
                    <option value="Fatiga">Fatiga</option>
                    <option value="Prisa">Prisa</option>
                    <option value="Frustración">Frustración</option>
                    <option value="Exceso de confianza">Exceso de confianza</option>
                    <option value="Ninguno">Ninguno</option>
                </select>
            </div>
            <div class="form-group">
                <label>Subir fotografía de observación realizada *</label>
                <input type="file" id="fotoTrabajador" accept="image/*">
                <span class="file-label">Obligatorio para registro de observación directa.</span>
            </div>
        </div>

        <div id="seccionCondicion" class="section hidden">
            <h3>II. CONDICIÓN INSEGURA</h3>
            <div class="form-group">
                <label>Descripción del riesgo detectado (especificar lugar) *</label>
                <textarea id="condicionDesc" name="descripcionCondicion" rows="3" placeholder="Detalle la falla o riesgo..."></textarea>
            </div>
            <div class="form-group">
                <label>Evidencia Fotográfica *</label>
                <input type="file" id="fotoFile" accept="image/*">
            </div>
            <div class="form-group">
                <label>Responsables de atención (Seleccione al menos uno) *</label>
                <div class="checkbox-grid" id="gridResponsables">
                    <label class="checkbox-item"><input type="checkbox" class="resp-check" value="Biol. Leonel De Jesus Perera Ak"> Biol. Leonel De Jesus Perera Ak</label>
                    <label class="checkbox-item"><input type="checkbox" class="resp-check" value="Lic. Rafael Jesus Perez Avila"> Lic. Rafael Jesus Perez Avila</label>
                    <label class="checkbox-item"><input type="checkbox" class="resp-check" value="QI. Gustavo Jauregui Mejia"> QI. Gustavo Jauregui Mejia</label>
                    <label class="checkbox-item"><input type="checkbox" class="resp-check" value="Ing. Mario Guzman Ordaz"> Ing. Mario Guzman Ordaz</label>
                    <label class="checkbox-item"><input type="checkbox" class="resp-check" value="Ing. Roberto Daniel Orozco De La Cruz"> Ing. Roberto Daniel Orozco De La Cruz</label>
                    <label class="checkbox-item"><input type="checkbox" class="resp-check" value="Ing. Alberto Pastor Zamudio Rodriguez"> Ing. Alberto Pastor Zamudio Rodriguez</label>
                    <label class="checkbox-item"><input type="checkbox" class="resp-check" value="Ing. Julio Cesar Lopez Poot"> Ing. Julio Cesar Lopez Poot</label>
                    <label class="checkbox-item"><input type="checkbox" class="resp-check" value="Ing. Imer Sebastian Maldonado Marrufo"> Ing. Imer Sebastian Maldonado Marrufo</label>
                    <label class="checkbox-item"><input type="checkbox" class="resp-check" value="Ing. Jorge Urbano Hernandez Muro"> Ing. Jorge Urbano Hernandez Muro</label>
                    <label class="checkbox-item"><input type="checkbox" class="resp-check" value="Ing. Jenniffer Basulto Espadas"> Ing. Jenniffer Basulto Espadas</label>
                    <label class="checkbox-item"><input type="checkbox" class="resp-check" value="QI. Sergio Alberto Maldonado Perez"> QI. Sergio Alberto Maldonado Perez</label>
                    <label class="checkbox-item"><input type="checkbox" class="resp-check" value="Biol. Carlos Eduardo Olivera Calderon"> Biol. Carlos Eduardo Olivera Calderon</label>
                    <label class="checkbox-item"><input type="checkbox" class="resp-check" value="Dr. Álvaro Arellano López"> Dr. Álvaro Arellano López</label>
                </div>
            </div>
        </div>

        <button type="submit" id="btnEnviar">Guardar Reporte</button>
    </form>
</div>

<script>
    const scriptURL = "https://script.google.com/macros/s/AKfycbzL2cKPBNHnXvlvlm_5QtX9VDYws-2PmJRRc5ck_ZpjqKt8c7jGsARgGXhBJZqBKgs/exec";
    const LOGO_BASE64 = "data:image/png;base64,TU_LOGO_EN_BASE64_AQUÍ";

    window.onload = () => {
        document.getElementById('fechaActual').valueAsDate = new Date();
        cargarListas();
    };

    async function cargarListas() {
        try {
            const response = await fetch(scriptURL);
            const data = await response.json();
            const dlObservador = document.getElementById('listaObservadores');
            const dlObservado = document.getElementById('listaObservados');
            if(data.observadores) data.observadores.forEach(n => { let o = document.createElement('option'); o.value = n; dlObservador.appendChild(o); });
            if(data.observados) data.observados.forEach(n => { let o = document.createElement('option'); o.value = n; dlObservado.appendChild(o); });
        } catch (e) { console.log("Listas no cargadas"); }
    }

    function toggleOtroLugar() {
        const select = document.getElementById('sitioSelect');
        const input = document.getElementById('otroSitio');
        input.classList.toggle('hidden', select.value !== 'Otro');
        input.required = (select.value === 'Otro');
    }

    function toggleOtroRazon() {
        const select = document.getElementById('razonInseguraSelect');
        const input = document.getElementById('otroRazonInsegura');
        input.classList.toggle('hidden', select.value !== 'Otro');
        input.required = (select.value === 'Otro');
    }

    function toggleOtroFaltante() {
        const check = document.getElementById('checkOtroFaltante');
        const input = document.getElementById('otroFaltante');
        input.classList.toggle('hidden', !check.checked);
        if(check.checked) input.focus();
        input.required = check.checked;
    }

    function toggleSections() {
        const tipo = document.getElementById('tipoObservacion').value;
        const seccionActo = document.getElementById('seccionActo');
        const seccionCondicion = document.getElementById('seccionCondicion');
        
        seccionActo.classList.toggle('hidden', tipo !== 'acto');
        seccionCondicion.classList.toggle('hidden', tipo !== 'condicion');

        document.getElementById('inputObservado').required = (tipo === 'acto');
        document.getElementById('condicionDesc').required = (tipo === 'condicion');
    }

    function toggleProvisto() {
        const val = document.getElementById('provistoSelect').value;
        document.getElementById('queFalta').classList.toggle('hidden', val === 'SI');
    }

    function toggleEvita() {
        const val = document.getElementById('actividadSegura').value;
        document.getElementById('queEvita').classList.toggle('hidden', val === 'SI');
    }

    document.getElementById('seguridadForm').addEventListener('submit', async function(e) {
        e.preventDefault();
        const tipo = document.getElementById('tipoObservacion').value;
        const btn = document.getElementById('btnEnviar');
        
        if (!tipo) { alert("Por favor seleccione un tipo de observación."); return; }

        let fotoInput;
        if (tipo === 'acto') {
            fotoInput = document.getElementById('fotoTrabajador');
            if (fotoInput.files.length === 0) {
                alert("⚠️ Debe subir la foto con el trabajador observado.");
                return;
            }
        } else {
            fotoInput = document.getElementById('fotoFile');
            const responsables = document.querySelectorAll('.resp-check:checked');
            if (responsables.length === 0) {
                alert("⚠️ Seleccione al menos un responsable para la condición insegura.");
                return;
            }
            if (fotoInput.files.length === 0) {
                alert("⚠️ Debe subir una foto de evidencia de la condición.");
                return;
            }
        }

        btn.innerText = "PROCESANDO... ESPERE";
        btn.disabled = true;

        const formData = new FormData(this);
        const payload = {};
        formData.forEach((v, k) => { 
            if (k === 'sitio' && v === 'Otro') {
                payload[k] = formData.get('otroSitio');
            } else if (k === 'razonInsegura' && v === 'Otro') {
                payload[k] = formData.get('otroRazonInsegura');
            } else {
                payload[k] = v;
            }
        });

        const faltantesArr = Array.from(document.querySelectorAll('input[name="falta"]:checked')).map(cb => {
            if(cb.value === 'Otro') {
                return "Otro: " + document.getElementById('otroFaltante').value;
            }
            return cb.value;
        });
        payload.falta = faltantesArr.join(", ");

        const responsablesArr = Array.from(document.querySelectorAll('.resp-check:checked')).map(cb => cb.value.trim());
        payload.responsables = responsablesArr.join(", ");

        const reader = new FileReader();
        reader.onload = async (ev) => {
            payload.fotografia = ev.target.result;
            await enviar(payload, btn);
        };
        reader.readAsDataURL(fotoInput.files[0]);
    });

    async function enviar(payload, btn) {
        const params = new URLSearchParams();
        for (const k in payload) params.append(k, payload[k]);

        try {
            if (payload.tipoObservacion === 'condicion') {
                await generarPDF(payload);
                alert("Es importante dar aviso a las personas responsables para atender la condición insegura registrada.");
            }

            await fetch(scriptURL, { method: "POST", body: params, mode: 'no-cors' });
            alert("✅ ¡Reporte guardado exitosamente!");
            location.reload();
        } catch (error) {
            console.error("Error:", error);
            alert("❌ Error al procesar datos.");
            btn.disabled = false;
            btn.innerText = "Guardar Reporte";
        }
    }

    async function generarPDF(datos) {
        const { jsPDF } = window.jspdf;
        const doc = new jsPDF('p', 'mm', 'a4');
        
        try {
            doc.addImage(LOGO_BASE64, 'PNG', 15, 10, 30, 20);
        } catch (e) {
            console.warn("No se pudo cargar el logo en el PDF.");
        }

        doc.setFont("helvetica", "bold");
        doc.setFontSize(16);
        doc.setTextColor(0, 35, 68); 
        doc.text("Reporte de Condición Insegura", 50, 20);
        doc.setFontSize(10);
        doc.text("Industria Salinera de Yucatán S.A de C.V.", 50, 26);
        
        doc.autoTable({
            startY: 40,
            head: [['Campo', 'Información']],
            body: [
                ['Fecha de Reporte', datos.fecha],
                ['Sitio / Lugar', datos.sitio],
                ['Nombre del Observador', datos.observador],
                ['Descripción del Riesgo', datos.descripcionCondicion],
                ['Responsables Asignados', datos.responsables]
            ],
            headStyles: { fillColor: [0, 35, 68] }, 
            theme: 'grid'
        });

        if (datos.fotografia) {
            doc.addPage();
            doc.setFontSize(12);
            doc.text("EVIDENCIA FOTOGRÁFICA", 15, 20);
            doc.addImage(datos.fotografia, 'JPEG', 15, 30, 180, 135);
        }
        
        doc.save(`Reporte_ISYSA_${datos.fecha}.pdf`);
    }
</script>
</body>
</html>




